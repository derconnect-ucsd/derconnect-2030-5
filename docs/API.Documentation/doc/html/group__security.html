<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EPRI 2030.5 Client: Security</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EPRI 2030.5 Client
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__security.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Security</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga1b09f2f73eb988a994e010525463c4ba"><td class="memItemLeft" align="right" valign="top"><a id="ga1b09f2f73eb988a994e010525463c4ba"></a>
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><b>VerifyFunc</b>) (void *context, uint8_t *cert, int length)</td></tr>
<tr class="separator:ga1b09f2f73eb988a994e010525463c4ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabae7ae3a93a3e0e7d8375a3f3a25724d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabae7ae3a93a3e0e7d8375a3f3a25724d">tls_init</a> (const char *path, VerifyFunc verify)</td></tr>
<tr class="memdesc:gabae7ae3a93a3e0e7d8375a3f3a25724d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the TLS library.  <a href="#gabae7ae3a93a3e0e7d8375a3f3a25724d">More...</a><br /></td></tr>
<tr class="separator:gabae7ae3a93a3e0e7d8375a3f3a25724d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadea9b85056a9814af0f31825e3c4cfe7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gadea9b85056a9814af0f31825e3c4cfe7">load_cert</a> (const char *path)</td></tr>
<tr class="memdesc:gadea9b85056a9814af0f31825e3c4cfe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a CA certificate.  <a href="#gadea9b85056a9814af0f31825e3c4cfe7">More...</a><br /></td></tr>
<tr class="separator:gadea9b85056a9814af0f31825e3c4cfe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a1ba6975237933bc8447986ea73fe08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7a1ba6975237933bc8447986ea73fe08">load_cert_dir</a> (const char *path)</td></tr>
<tr class="memdesc:ga7a1ba6975237933bc8447986ea73fe08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a CA certificate directory.  <a href="#ga7a1ba6975237933bc8447986ea73fe08">More...</a><br /></td></tr>
<tr class="separator:ga7a1ba6975237933bc8447986ea73fe08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6821c2ae8cba93d7e61ebbb3bab48002"><td class="memItemLeft" align="right" valign="top"><a id="ga6821c2ae8cba93d7e61ebbb3bab48002"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>print_bytes</b> (unsigned char *data, int n)</td></tr>
<tr class="separator:ga6821c2ae8cba93d7e61ebbb3bab48002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e83013b684ca7c97129148e672a5d83"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0e83013b684ca7c97129148e672a5d83">sfdi_gen</a> (uint8_t *lfdi)</td></tr>
<tr class="memdesc:ga0e83013b684ca7c97129148e672a5d83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate SFDI from LFDI hash.  <a href="#ga0e83013b684ca7c97129148e672a5d83">More...</a><br /></td></tr>
<tr class="separator:ga0e83013b684ca7c97129148e672a5d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c3b1ec1fd87c9cfb07b82f97655ed1f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0c3b1ec1fd87c9cfb07b82f97655ed1f">lfdi_hash</a> (uint8_t *lfdi, uint8_t *buffer, int length)</td></tr>
<tr class="memdesc:ga0c3b1ec1fd87c9cfb07b82f97655ed1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate SFDI and LFDI hash values from a device certificate.  <a href="#ga0c3b1ec1fd87c9cfb07b82f97655ed1f">More...</a><br /></td></tr>
<tr class="separator:ga0c3b1ec1fd87c9cfb07b82f97655ed1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6dbafb6acf80fc86e418814b288a7e1a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6dbafb6acf80fc86e418814b288a7e1a">lfdi_gen</a> (uint8_t *lfdi, const char *path)</td></tr>
<tr class="memdesc:ga6dbafb6acf80fc86e418814b288a7e1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate SFDI and LFDI hash values from a device certificate file.  <a href="#ga6dbafb6acf80fc86e418814b288a7e1a">More...</a><br /></td></tr>
<tr class="separator:ga6dbafb6acf80fc86e418814b288a7e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85dca7ededd3e531ce19183751f71ff4"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga85dca7ededd3e531ce19183751f71ff4">load_device_cert</a> (uint8_t *lfdi, const char *path)</td></tr>
<tr class="memdesc:ga85dca7ededd3e531ce19183751f71ff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate SFDI and LFDI hash values from a device certificate file and print them to the console.  <a href="#ga85dca7ededd3e531ce19183751f71ff4">More...</a><br /></td></tr>
<tr class="separator:ga85dca7ededd3e531ce19183751f71ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37aa027507f0512a802bc034def54576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga37aa027507f0512a802bc034def54576">security_init</a> (const char *path)</td></tr>
<tr class="memdesc:ga37aa027507f0512a802bc034def54576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the device SFDI and LDFI.  <a href="#ga37aa027507f0512a802bc034def54576">More...</a><br /></td></tr>
<tr class="separator:ga37aa027507f0512a802bc034def54576"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga6dbafb6acf80fc86e418814b288a7e1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6dbafb6acf80fc86e418814b288a7e1a">&#9670;&nbsp;</a></span>lfdi_gen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t lfdi_gen </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>lfdi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate SFDI and LFDI hash values from a device certificate file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lfdi</td><td>is a 20 byte buffer that stores the LFDI result </td></tr>
    <tr><td class="paramname">path</td><td>is the path of the device certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the SFDI hash result truncated from the LFDI result </dd></dl>

</div>
</div>
<a id="ga0c3b1ec1fd87c9cfb07b82f97655ed1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c3b1ec1fd87c9cfb07b82f97655ed1f">&#9670;&nbsp;</a></span>lfdi_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t lfdi_hash </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>lfdi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate SFDI and LFDI hash values from a device certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lfdi</td><td>is a 20 byte buffer that stores the LFDI result </td></tr>
    <tr><td class="paramname">buffer</td><td>contains the device certificate, it must be a multiple of SHA256_HASH_SIZE (64 bytes) and have at least 9 bytes of padding, this can be obtained by allocating a buffer of size sha256_size (length). </td></tr>
    <tr><td class="paramname">length</td><td>is the length of the device certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the SFDI hash result truncated from the LFDI result </dd></dl>

</div>
</div>
<a id="gadea9b85056a9814af0f31825e3c4cfe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadea9b85056a9814af0f31825e3c4cfe7">&#9670;&nbsp;</a></span>load_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_cert </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a CA certificate. </p>
<p>This certificate can be sent along with client certificate as part of establishing a TLS session, it can also be used in CA certificate chain verification of a client certificate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>is the file name of the CA certificate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7a1ba6975237933bc8447986ea73fe08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a1ba6975237933bc8447986ea73fe08">&#9670;&nbsp;</a></span>load_cert_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_cert_dir </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a CA certificate directory. </p>
<p>Call <a class="el" href="group__security.html#gadea9b85056a9814af0f31825e3c4cfe7">load_cert</a> for every file in the directory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>is the file name of the directory to load </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga85dca7ededd3e531ce19183751f71ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga85dca7ededd3e531ce19183751f71ff4">&#9670;&nbsp;</a></span>load_device_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t load_device_cert </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>lfdi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate SFDI and LFDI hash values from a device certificate file and print them to the console. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lfdi</td><td>is a 20 byte buffer that stores the LFDI result </td></tr>
    <tr><td class="paramname">path</td><td>is the path of the device certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the SFDI hash result truncated from the LFDI result </dd></dl>

</div>
</div>
<a id="ga37aa027507f0512a802bc034def54576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga37aa027507f0512a802bc034def54576">&#9670;&nbsp;</a></span>security_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_init </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the device SFDI and LDFI. </p>
<p>Initialize the global variable device_lfdi and device_sfdi by computing the hash of a device certificate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>is the path of the device certificate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0e83013b684ca7c97129148e672a5d83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e83013b684ca7c97129148e672a5d83">&#9670;&nbsp;</a></span>sfdi_gen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t sfdi_gen </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>lfdi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate SFDI from LFDI hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lfdi</td><td>is the 20 byte LFDI </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the computed SFDI result </dd></dl>

</div>
</div>
<a id="gabae7ae3a93a3e0e7d8375a3f3a25724d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabae7ae3a93a3e0e7d8375a3f3a25724d">&#9670;&nbsp;</a></span>tls_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * tls_init </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VerifyFunc&#160;</td>
          <td class="paramname"><em>verify</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the TLS library. </p>
<p>Initialize the TLS library calling the appropriate functions. Load the device certificate 'path'.x509 and use the device private key 'path'.pem, where 'path' is the first function parameter. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>is used to identify the device certificate and private key files, 'path'.x509 and 'path'.pem respectively. </td></tr>
    <tr><td class="paramname">verify</td><td>is called as extra step to verify the client TLS certificate. Certificates are in any case are verified against their CA certificate chain, this extra step this can be used to impliment a filter by only accepting clients with the right credentials (SFDI, LFDI), this parameter can be NULL to indicate not to take this step. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the path of the device certificate 'path'.x509 </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
